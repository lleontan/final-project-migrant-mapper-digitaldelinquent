p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
borderwidth = 0.5
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
borderwidth = 0.1
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
thickness = 10
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
thickness = 15,
tickfont = list(size = 1)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
thickness = 15,
tickfont = list(size = 15)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
thickness = 15,
tickfont = list(size = 5)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
thickness = 15,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
runApp()
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,nticks = 8),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(bir)
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,tickangle = 55),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,ticklen = 2),
yaxis = list(showgrid = FALSE)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,
ticklen = 3,
tickmode = "linear"),
yaxis = list(showgrid = FALSE,
ticklen = 3)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,
ticklen = 3,
tickmode = "auto",
nticks = 8,
tickangle = 60),
yaxis = list(showgrid = FALSE,
ticklen = 3)
)
return(p)
}
SearchByCountry(birthplaces,"China")
SearchByCountry <- function(d,country){
yearIndexes<-grep("X", colnames(d))
yearNames<-as.numeric(gsub("X",x=colnames(birthplaces[yearIndexes]), replacement=""))
d <- d %>%
filter(OdName == country)
x <- d[yearIndexes]
population <- as.numeric(paste(x))
yearNames <- as.numeric(yearNames)
m <- data.frame(yearNames,population)
m <- na.exclude(m)
p <- plot_ly(m,
x = ~yearNames,
y = ~population,
text = country,
type = "scatter",
mode = "markers",
color = ~population,
colors = "Accent",
size = ~population,
sizes = c(3,35),
marker = list(
colorbar = list(
title = "population",
titlefont = list(size = 10),
thickness = 12,
tickfont = list(size = 10)
),
sizemode = "diameter",
opacity = 0.7
)) %>%
layout(title = paste0("Imigrants change of ", country),
xaxis = list(showgrid = FALSE,
ticklen = 3,
len = 10,
title = "year"),
yaxis = list(showgrid = FALSE,
ticklen = 3)
)
return(p)
}
SearchByCountry(birthplaces,"China")
runApp()
